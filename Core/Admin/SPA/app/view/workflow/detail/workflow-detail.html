<div class="ui-g ui-fluid" id="workflow-detail" *ngIf="(item$ | async)">

    <div class="ui-g-12 no-padding">


        <div class="ui-g-12">
            <div class="ui-g card card-w-title border-radius border-light no-margin-b">
                <h1 style="display: block !important; font-size: 30px;" class="no-margin">Workflow details</h1>
            </div>
        </div>

        <div class="ui-g-12 ui-lg-4">


            <div class="ui-g-12 no-padding">
                <div class="ui-g card card-w-title border-radius border-light">

                    <!-- ANIMATION WORKFLOW GOES HERE -->
                    <div class="svg-wrapper margin-auto">
                        <svg id="workflow-svg" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 241 411">
                            <defs>
                                <style>
                                    .cls-1 {
                                        fill: #f9ba48;
                                    }
                                    .cls-2 {
                                        fill: #333;
                                    }
                                    .cls-3 {
                                        fill: none;
                                        stroke: #a6c0e4;
                                    }
                                    .cls-3,
                                    .cls-4 {
                                        stroke-miterlimit: 10;
                                        stroke-width: 9px;
                                    }
                                    .cls-4 {
                                        fill: #fff;
                                        stroke: #000;
                                    }
                                </style>
                            </defs>
                           
                            <g id="lightbulb">
                                <path id="bulb" class="cls-1" d="M144.41,95.24H96.79V67.81a38.09,38.09,0,1,1,47.62,0V95.24Z" />
                                <path class="cls-2" d="M149.17,71.43H125.36V51.51a14.29,14.29,0,1,0-9.52,0V71.43H92V81h57.14V71.43ZM120.6,33.33a4.77,4.77,0,1,1-4.76,4.77A4.77,4.77,0,0,1,120.6,33.33Z"
                                />
                                <g id="flash">
                                    <rect class="cls-1" x="56.79" y="34.11" width="19.93" height="7.97" />
                                    <rect class="cls-1" x="60.88" y="54.7" width="19.93" height="7.97" transform="translate(-17.07 31.59) rotate(-22.51)"
                                    />
                                    <rect class="cls-1" x="166.03" y="48.72" width="7.97" height="19.93" transform="translate(50.73 193.3) rotate(-67.5)"
                                    />
                                    <rect class="cls-1" x="164.14" y="34.11" width="19.93" height="7.97" />
                                    <rect class="cls-1" x="160.05" y="13.52" width="19.92" height="7.97" transform="translate(6.25 66.41) rotate(-22.51)"
                                    />
                                    <rect class="cls-1" x="66.87" y="7.53" width="7.97" height="19.93" transform="translate(27.57 76.26) rotate(-67.5)"
                                    />
                                </g>
                            </g>
                            <polyline id="line-left" class="cls-3" points="120.43 359.24 120.43 322.69 35.51 322.69 35.51 140.61 120.43 140.61 120.43 95.24"
                            />
                            <polyline id="line-right" class="cls-3" points="120.43 359.24 120.43 322.69 205.36 322.69 205.36 140.61 120.43 140.61 120.43 95.24"
                            />
                            <line id="line-middle" class="cls-3" x1="120.43" y1="359.24" x2="120.43" y2="95.24" />
                            <rect id="box-1" class="cls-4" x="4.5" y="208.95" width="62.01" height="46.1" />
                            <rect id="box-2" class="cls-4" x="89.31" y="208.95" width="62.01" height="46.1" />
                            <rect id="box-3" class="cls-4" x="174.24" y="208.95" width="62.01" height="46.1" />
                            <rect id="box-4" class="cls-4" x="89.43" y="359.24" width="62.01" height="46.76" rx="12" ry="12" />
                        </svg>
                    </div>

                    <!-- END WORKFLOW ANIMATION  -->

                    <!-- DEBUG PURPOSE -->

                    <!-- <div>{{item$ | async | json}}</div>
                    <div>
                        {{ this.actualStatus$ | async }}
                    </div> -->

                    <div class="ui-g" *ngIf="(item$ | async).id != ''">
                        <button type="button" style="width: 100px;" pButton icon="fa-play" label="RUN" (click)="runWorkflow()" class="ui-button-success"></button>
                        <button type="button" style="width: 100px;" pButton icon="fa-stop" label="STOP" (click)="stopWorkflow()" class="ui-button-danger"></button>
                        <button type="button" style="width: 100px;" pButton icon="fa-retweet" label="CHECK" (click)="checkWorkflow()" class="ui-button-info"></button>
                    </div>

                </div>
            </div>
        </div>


        <!-- ////////// EDIT ////////// -->

        <div class="ui-g-12 ui-lg-8">

            <div class="ui-g card card-w-title border-radius border-light">
                <!-- ////////// TAGS ////////// -->
                <div class="ui-g-12">
                    <h2 class="no-margin-t">Tags</h2>
                </div>

                <div class="ui-g-12" *ngIf="allowEdit === false">
                    <!-- <span> -->
                    <span *ngFor="let tag of selectedTags">
                        <span [ngClass]="'tag'">
                            {{tag}}
                        </span>
                    </span>
                    <!-- </span> -->

                </div>

                <div class="ui-g-12" *ngIf="allowEdit === true">
                    <p-chips id="tags" [(ngModel)]="selectedTags" placeholder="Tags:" [ngModelOptions]="{standalone: true}"></p-chips>
                </div>
            </div>

            <div class="ui-g card card-w-title border-radius border-light">
                <!-- ////////// TRIGGER ////////// -->
                <div class="ui-g-12">
                    <h2 class="no-margin-t">Trigger</h2>
                </div>

                <div class="ui-g-12" *ngIf="allowEdit === false">
                    <div class="flex margin-b-large">
                        <div class="flex__1">
                            <p>Trigger type</p>
                        </div>

                        <div class="flex__2">
                            <p>{{ triggerType }}</p>
                        </div>
                    </div>

                    <div class="flex">
                        <div class="flex__1">
                            <p>Trigger parameters</p>
                        </div>

                        <div class="flex__2">
                            <div *ngFor="let key of objectKeys(triggerParams)">
                                <p>{{ triggerParams[key] + ' ' + (key) }}</p>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="ui-g-3 ui-md-3 ui-sm-12" *ngIf="allowEdit === true">
                    <label for="triggerType">Trigger type: </label>
                    <div class="border-radius">
                        <p-dropdown id="triggertype" name="triggerType" [options]="triggerTypes" [(ngModel)]="selectedTriggerType" [autoWidth]="false"
                            [ngModelOptions]="{standalone: true}">
                        </p-dropdown>
                    </div>
                </div>

                <div class="ui-g-9 ui-md-9 ui-sm-12" *ngIf="allowEdit === true">
                    <trigger-time *ngIf="selectedTriggerType == 'time'" [item]="item$ | async" (onSave)="setTrigger($event)">
                    </trigger-time>
                    <trigger-mqtt *ngIf="selectedTriggerType == 'mqtt'" [item]="item$ | async" (onSave)="setTrigger($event)">
                    </trigger-mqtt>
                </div>


            </div>



            <div class="ui-g card card-w-title border-radius border-light">
                <!-- ////////// WORKFLOW ////////// -->
                <div class="ui-g-12">
                    <h2 class="no-margin-t">Workflow</h2>
                </div>

                <div class="ui-g-12" *ngIf="allowEdit === false">
                    <div class="flex margin-b-large">
                        <div class="flex__1">
                            <p>Workflow type</p>
                        </div>

                        <div class="flex__2">
                            <p>{{ workflowType }}</p>
                        </div>
                    </div>

                    <div class="flex">

                        <div class="flex__1">
                            <p>Workflow parameters</p>
                        </div>

                        <div class="flex__2">
                            <div *ngFor="let key of objectKeys(workflowParams)">
                                <p>{{ key + ' - ' + workflowParams[key] }}</p>
                            </div>
                        </div>


                    </div>

                </div>

                <div class="ui-g-3 ui-sm-12 ui-md-3" *ngIf="allowEdit === true">
                    <label for="workflowType">Workflow type: </label>
                    <div class="border-radius">
                        <p-dropdown id="workflowtype" name="workflowType" [options]="workflowTypes" [(ngModel)]="selectedWorkflowType" [autoWidth]="false"
                            [ngModelOptions]="{standalone: true}">
                        </p-dropdown>
                    </div>
                </div>

                <div class="ui-g-9 ui-sm-12 ui-md-9" *ngIf="allowEdit === true">
                    <workflow-rand2mqtt *ngIf="selectedWorkflowType == 'rand2mqtt'" [item]="item$ | async" (onSave)="setWorkflow($event)">
                    </workflow-rand2mqtt>

                    <!-- TESTEXCEPTION -->
                    <workflow-testexception *ngIf="selectedWorkflowType == 'testexception'" [item]="item$ | async" (onSave)="setWorkflow($event)">
                    </workflow-testexception>

                    <!-- TEST1 -->
                    <workflow-test1 *ngIf="selectedWorkflowType == 'test1'" [item]="item$ | async" (onSave)="setWorkflow($event)">
                    </workflow-test1>

                    <!-- DEFAULTSENZOR -->
                    <workflow-defaultsenzor *ngIf="selectedWorkflowType == 'defaultsenzor'" [item]="item$ | async" (onSave)="setWorkflow($event)">
                    </workflow-defaultsenzor>
                </div>


                <!-- </div> -->
                <!-- </div> -->
            </div>

            <div class="card card-w-tittle border-radius border-light">
                <div *ngIf="(item$ | async) && selectedWorkflowType != ''&& selectedTriggerType != ''">
                    <button *ngIf="allowEdit === true" type="button" pButton icon="fa-check" label="SAVE" (click)="saveWorkflow()" style="width:125px; height: 40px;"
                        class="ui-button-success"></button>
                    <button *ngIf="allowEdit === true" type="button" pButton icon="fa-trash" label="DELETE" (click)="deleteWorkflow()" style="width:125px; height: 40px;"
                        class="ui-button-danger"></button>
                    <button *ngIf="allowEdit === false" type="button" pButton icon="fa-edit" label="EDIT" (click)="editWorkflow()" style="width:125px; height: 40px;"
                        class="ui-button-info"></button>
                    <button *ngIf="allowEdit === true" type="button" pButton icon="fa-times-circle" label="CANCEL" (click)="cancelEditWorkflow()"
                        style="width:125px; height: 40px;" class="ui-button-warning"></button>
                </div>
            </div>
        </div>
    </div>








    <!-- <div class="ui-g" *ngIf="(item$ | async) && selectedTriggerType != ''">
    
        <trigger-time *ngIf="selectedTriggerType == 'time'" [item]="item$ | async" (onSave)="setTrigger($event)">
        </trigger-time>
        
        <trigger-mqtt *ngIf="selectedTriggerType == 'mqtt'" [item]="item$ | async" (onSave)="setTrigger($event)">
        </trigger-mqtt>

    </div> -->
</div>